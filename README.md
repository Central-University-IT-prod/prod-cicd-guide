# Гайд по настройке Github Actions в проекте

Небольшой гайдлайн по настройке CI/CD в Ваших проектах.

По всем вопросам в TG - @akrbout.

## Этап 1 - Устанавливаем раннеры на виртуальные машины

Все пайплайны будут исполняться удаленно, на Ваших виртуальных машинах. Содержимое проекта клонится на диск машины, после чего выполняются действия, описанные в пайплайне.

Заходим в настройки проекта, в пункт Runners. Нажимаем на кнопку "New self-hosted runner".

![github runner creation](/static/img/runner-creation-first.png)

Видим список команд, которые необходимо выполнить на машине для установки раннера. Для того чтобы можно было запустить установку под рутованным профилем, перед исполнением всех команд добавляем в ENV системы параметр, разрешающий  делать все под рутом.

```shell
export RUNNER_ALLOW_RUNASROOT=1
```

Запускаем установку, пропуская этап запуска вручную.

![github runner installation](/static/img/runner-creation-second.png)

Чтобы нам не пришлось каждый раз запускать раннера руками, настроим его запуск as-a-service (благо Ubuntu нам это позволяет сделать).

В той же директории запускаем `.sh` скрипт для установки сервиса:
```shell
sudo ./svc.sh install
```
Запустим сервис:
```shell
sudo ./svc.sh start
```
Статус раннера можно узнать командой:
```shell
sudo ./svc.sh status
```

Теперь в Github Runners отображается наш только что созданный раннер.

![github runner idle](/static/img/runner-creation-final.png)

## Этап 2 - Формируем Workflow и запускаем его на раннере

Все пайплайны Github хранит по пути `/.github/workflows/`, каждый файл формата `.yml`.
